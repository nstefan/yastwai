# YASTwAI Rules and Guidelines

These rules provide guidance for the AI agent working with the YASTwAI codebase.

## Core Rules

1. Everything must be produced in english.
   - code
   - comments
   - documentation (README and other file headers)

2. Every command must not be interactive since we are dealing with a bot.
   - use proper arguments to prevent user interaction with commands.
   - use AI-optimized helper scripts with the naming pattern `ai-*-helper.sh` for non-interactive operations.

3. Everytime the user sends a prompt, automatically commit changes at the end when you're confident everything is ok.
   - Check if the prompt is still related to the current branch, if not create a new branch from the main branch.
   - Use the `ai-branch-helper.sh` script for non-interactive branch management:
   ```bash
   ./scripts/ai-branch-helper.sh --check-only                          # Check branch status only
   ./scripts/ai-branch-helper.sh --new-branch "feature-name" --is-related false  # Create new branch from main
   ```
   - Never commit on the main branch.
   - Use the `ai-commit-helper.sh` script to generate commits in the correct format:
   ```bash
   ./scripts/ai-commit-helper.sh --title "Commit title" --description "Short description" --prompt "Original prompt" --thought-process "Reasoning process line 1,Reasoning process line 2" --discussion "Challenge faced,Solution implemented"
   ```
   - Follow the detailed guidelines in CONTRIBUTING.md for reference.

4. Whenever a code source file have been modified, always finish by building the app and run unit tests in release mode.
   - Don't adress warnings in test files as long as they run properly.
   - Use the `ai-clippy-helper.sh` script for non-interactive linting:
   ```bash
   ./scripts/ai-clippy-helper.sh --check-only    # Only check for linting issues
   ./scripts/ai-clippy-helper.sh --fix           # Try to fix linting issues
   ```
   - #[allow(dead_code)] directive is forbidden to fix warnings except to silence warnings related to tests in production code.

5. When a test breaks, BE CAREFUL!
   - You must check first if it's the modification the problem before tryin to adapt the test to the new changes.

6. PR creation instructions, ONLY create PRs when EXPLICITLY requested by the user.
   - NEVER create a PR automatically or as part of another task unless directly requested.
   - ALWAYS use the `ai-pr-helper.sh` script as the preferred method for PR creation:
   ```bash
   ./scripts/ai-pr-helper.sh --title "PR Title" --overview "Brief overview" --key-changes "Change 1,Change 2" --implementation "Detail 1,Detail 2"
   ```
   - This helper avoids multiline command issues and creates well-structured PRs with proper section formatting.
   - When a PR is explicitly requested, leverage AI capabilities for intelligent summarization:
      - Analyzing all commits on the branch to understand the complete change set
      - Generating a well-structured PR body with emoji-enhanced sections
      - At the end, create a PR title that accurately reflects a summary of the changes

7. When creating PRs, structure the PR body with emoji-enhanced sections:
   - üß† **Instructions**
     Prompt: 
       ```
       <Original prompt or request as plain text>
       ```
     Chain of thoughts: 
       ```
       <Reasoning process used by the agent as plain text>
       ```
   - üìå **Overview**: Brief summary of what the PR accomplishes (2-3 sentences)
   - üîç **Key Changes**: Bullet points of the most significant changes
   - üß© **Implementation Details**: Technical approach and design decisions
   - üîÑ **Migration Notes**: Any changes requiring updates to existing code
   - ‚ö†Ô∏è **Areas of Attention**: Parts of the PR that need special review focus
   - üìù **Commit Details**: Historical record of all commits
   - üìÅ **Files Changed**: For listing modified files

8. Commit Message Structure Reference (generated by ai-commit-helper.sh):
   ```
   <Concise summary as title>

   Short description: <Brief description of the changes>

   Prompt: <Original prompt or request>

   Chain of thoughts: <Reasoning process used by the agent>

   Discussion: <Challenges faced and how they were resolved>
   ```

## Available AI Helper Scripts

The repository includes several optimized scripts specifically designed for AI agent use:

1. `ai-branch-helper.sh` - Non-interactive branch management
   - Checks branch status and creates new branches as needed
   - Uses named parameters rather than interactive prompts

2. `ai-commit-helper.sh` - Non-interactive commit creation
   - Creates properly formatted commits with structured information
   - Supports comma-separated lists for multiline sections

3. `ai-clippy-helper.sh` - Non-interactive Rust linting
   - Runs Clippy checks and auto-fixes as needed
   - Provides clear error messaging and exit codes

4. `ai-pr-helper.sh` - Non-interactive PR creation
   - Creates well-structured PRs with proper formatting
   - Automatically detects files and commits where possible

These scripts are optimized for AI agent use and should be preferred over their interactive counterparts. 